Physijs.scripts.worker="js/physijs/physijs_worker.js";Physijs.scripts.ammo="ammo.js";
var PRIZE_DISTANCE=250,App={initialTime:90,timer:0,score:0,perToyScore:100,maxScoreCount:6,status:"Initial",setInitialStates:function(){for(var a in App.prizeToys)App.prizeToys[a].count=0,App.toys[a].isCatched=!1;App.currentPrizeToy=App.prizeToys.AngryBird;for(a=0;a<document.getElementsByClassName("star").length;a++)document.getElementsByClassName("star")[a].classList.remove("active");App.score=0;App.updateArrowUI();App.updateTextUI();App.updatePagination();App.prizecamera.position.set(0,0,200)},
onAppStart:function(){App.timer=App.initialTime;App.status="Start";App.setClockRunning()},onAppResume:function(){App.status="Resume";App.setClockRunning()},onAppPause:function(){App.status="Pause";clearInterval(App.timeIntervalFunc)},onAppEnd:function(){App.status="End";var a=document.getElementById("GameOverMenu"),b=document.getElementsByClassName("star");a.classList.add("open");a=App.score/(App.perToyScore*App.maxScoreCount);0!=a&&a<1/b.length&&(a=1/b.length);for(var c=0;c<b.length&&c<=a*b.length-
1;c++)b[c].classList.add("active")},onAppRestart:function(){var a=document.getElementById("GameOverMenu");document.getElementById("startContainer");var b=document.getElementById("loadingContainer");document.getElementById("control-info");var c=document.getElementById("preGameContainer"),d=document.getElementById("prepareContainer"),e=document.getElementById("prepareText");a.classList.remove("open");d.style.opacity=0;e.textContent=3;b.style.opacity=1;c.style.display="";App.timer=App.initialTime;document.getElementById("countdownText").textContent=
"01:30";for(App.generateSound("button");0<App.toysArray.length;)App.scene.remove(App.toysArray[App.toysArray.length-1]),App.toysArray.pop(),App.leftAmount--;var f=setInterval(function(){App.leftAmount<App.initialItemCount?App.dropToy(1):clearInterval(f);if(10<=App.leftAmount&&1!=d.style.opacity){d.style.opacity=1;var a=setInterval(function(){var d=parseInt(e.textContent)-1;e.textContent=d;0>=e.textContent&&(b.style.opacity=0,e.textContent="GO",clearInterval(a),setTimeout(function(){c.style.display=
"none";App.setInitialStates();App.onAppStart()},1001))},1E3)}},300)},timeIntervalFunc:"",setClockRunning:function(){App.timeIntervalFunc=setInterval(function(){App.timer--;var a="0"+parseInt(App.timer/60),b=(10>parseInt(App.timer%60)?"0":"")+parseInt(App.timer%60);document.getElementById("countdownText").textContent=a+":"+b;0>=App.timer&&(document.getElementById("countdownText").textContent="00:00",clearInterval(App.timeIntervalFunc),App.onAppEnd())},1E3)},toysArray:[],toys:{AngryBird:{model_url:"model/angrybird.dae",
model:"",name:"AngryBird",element_position:{x:0,y:-20,z:0},position:{x:10,y:-30,z:0},rotation:{x:0,y:0,z:0},scale:3.5,boundingBox:{width:130,height:100,depth:90},progress:{loaded:0,total:0},isCatched:!1,wiki_url:"http://en.m.wikipedia.org/wiki/Angry_Bird"},Pikachu:{model_url:"model/pikachu.dae",model:"",name:"Pikachu",element_position:{x:PRIZE_DISTANCE,y:-50,z:0},position:{x:0,y:-50,z:10},rotation:{x:0,y:0,z:0},scale:14,boundingBox:{width:100,height:130,depth:140},progress:{loaded:0,total:0},isCatched:!1,
wiki_url:"http://en.m.wikipedia.org/wiki/Pikachu"},Pokeball:{model_url:"model/pokeball.dae",model:"",name:"Pokeball",element_position:{x:2*PRIZE_DISTANCE,y:-5,z:0},position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:.8,boundingBox:{width:90,height:90,depth:90},progress:{loaded:0,total:0},isCatched:!1,wiki_url:"http://en.m.wikipedia.org/wiki/Pokeball#Pok.C3.A9_Ball"},Maruko:{model_url:"model/maruko.dae",model:"",name:"Maruko",element_position:{x:3*PRIZE_DISTANCE,y:-60,z:0},position:{x:0,y:-60,z:0},
rotation:{x:0,y:0,z:0},scale:1.5,boundingBox:{width:100,height:140,depth:80},progress:{loaded:0,total:0},thumb_url:"http://images5.fanpop.com/image/photos/30600000/maruko-maruko-chan-30624653-225-225.jpg",isCatched:!1,wiki_url:"http://en.m.wikipedia.org/wiki/Maruko"},Kenny:{model_url:"model/kenny.dae",model:"",name:"Kenny",element_position:{x:4*PRIZE_DISTANCE,y:0,z:0},position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:.8,boundingBox:{width:100,height:120,depth:80},progress:{loaded:0,total:0},isCatched:!1,
wiki_url:"http://en.m.wikipedia.org/wiki/Kenny_McCormick"},Gabumon:{model_url:"model/gabumon.dae",model:"",name:"Gabumon",element_position:{x:5*PRIZE_DISTANCE,y:-60,z:0},position:{x:0,y:-62,z:34},rotation:{x:0,y:0,z:0},scale:3,boundingBox:{width:80,height:140,depth:120},progress:{loaded:0,total:0},isCatched:!1,wiki_url:"http://en.m.wikipedia.org/wiki/Gabumon#Gabumon"},Spongebob:{model_url:"model/spongebob.dae",model:"",name:"Spongebob",element_position:{x:6*PRIZE_DISTANCE,y:-80,z:-50},position:{x:0,
y:-80,z:0},rotation:{x:0,y:0,z:0},scale:.3,boundingBox:{width:120,height:165,depth:80},progress:{loaded:0,total:0},isCatched:!1,wiki_url:"http://en.m.wikipedia.org/wiki/SpongeBob_SquarePants_(character)"},Goku:{model_url:"model/wukong.dae",model:"",name:"Goku",element_position:{x:7*PRIZE_DISTANCE,y:-80,z:-50},position:{x:0,y:-80,z:0},rotation:{x:0,y:0,z:0},scale:.6,boundingBox:{width:100,height:165,depth:60},progress:{loaded:0,total:0},isCatched:!1,wiki_url:"http://en.m.wikipedia.org/wiki/Goku"}},
renderer:"",prizerenderer:"",scene:new Physijs.Scene,prizescene:new THREE.Scene,camera:"",clawcamera:new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1E3),prizecamera:"",leftAmount:0,initialItemCount:15,lowerlimitItemCount:10,timeCounterss:{minute:1,second:30},isGameStart:!1,controls:"",prizeToys:{AngryBird:"",Pikachu:"",Pokeball:"",Maruko:"",Kenny:"",Gabumon:"",Spongebob:"",Goku:""},prizePlaceHolder:{},currentPrizeToy:"",glasscontainer:"",claw:"",clawbaseconstraint:"",clawconstraints:[],
TopCar:"",topcarconstraint:"",topcarbaseconstraint:"",LineGeometry:"",PackageTexture:THREE.ImageUtils.loadTexture("img/question.png"),PackageMaterial:"",PressInterval:"",RotateInterval:"",MouseDownInterval:"",MINDISTANCE_TO_CONTAINER:60,DROPDISTANCE:400,MOVE_DISTANCE:60,MOVE_INTERVAL_TIME:600,isClawAnimating:!1,isCameraAnimating:!1,isCaptured:!1,isMainCanvasMouseDown:!1,MainCanvasMouseDownLocation:{x:0,y:0},containerTopBoxTextureX:void 0,containerTopBoxTextureZ:void 0,loadingTotalCount:0,loadingReadyCount:0,
preloadAssets:function(){document.getElementById("backgroundSound").volume=.5;for(var a in this.toys)this.loadToy3dModel(this.toys[a]),this.loadPrize3dModel(this.toys[a]),this.loadingTotalCount+=2},loadToy3dModel:function(a){var b=new THREE.ColladaLoader;b.options.convertUpAxis=!0;b.load(a.model_url,function(b){b=b.scene;b.position.set(a.position.x,a.position.y,a.position.z);b.scale.x=b.scale.y=b.scale.z=a.scale;b.updateMatrix();b.traverse(function(a){a.material&&(a.material.shading=1)});a.model=
b;a.model.name=a.name;App.loadingReadyCount++;if(App.loadingReadyCount===App.loadingTotalCount&&!App.renderer)App.onAssetLoaded()},function(a){App.updateProgressBar()})},loadPrize3dModel:function(a){var b=new THREE.ColladaLoader;b.options.convertUpAxis=!0;b.load(a.model_url,function(b){b=b.scene;b.position.set(a.element_position.x,a.element_position.y,a.element_position.z);b.rotation.set(a.rotation.x-Math.PI/2,a.rotation.y,a.rotation.z);b.scale.x=b.scale.y=b.scale.z=a.scale;b.name=a.name;b.wiki_url=
a.wiki_url;b.currentPrizeToyTargetRotation=0;b.count=0;b.visible=!1;App.prizeToys[b.name]=b;App.prizescene.add(b);"AngryBird"===a.name&&(App.currentPrizeToy=b,App.updatePagination());App.loadingReadyCount++;if(App.loadingReadyCount===App.loadingTotalCount&&!App.renderer)App.onAssetLoaded()},function(a){App.updateProgressBar()})},updateProgressBar:function(){var a=document.getElementById("progressbar");document.getElementById("bar").style.width=App.loadingReadyCount/App.loadingTotalCount*(a.clientWidth-
10)+"px"},onAssetLoaded:function(){App.updateProgressBar();var a=document.getElementById("startContainer"),b=document.getElementById("loadingContainer"),c=b.children[0],d=document.getElementById("control-info"),e=document.getElementById("preGameContainer"),f=document.getElementById("prepareContainer"),g=document.getElementById("prepareText");c.style.opacity=0;d.style.opacity=1;b.style.background="rgba(0,0,0,0.8)";App.init();a.style.opacity=1;a.style.zIndex=10;a.addEventListener("click",function(){App.generateSound("button");
b.style.background="rgba(0,0,0,0)";d.style.opacity=0;a.style.display="none";var c=setInterval(function(){App.leftAmount<App.initialItemCount?App.dropToy(1):clearInterval(c);if(10<=App.leftAmount&&1!=f.style.opacity){f.style.opacity=1;var a=setInterval(function(){var c=parseInt(g.textContent)-1;g.textContent=c;0>=g.textContent&&(b.style.opacity=0,g.textContent="GO",clearInterval(a),setTimeout(function(){e.style.display="none";App.onAppStart()},1001))},1E3)}},300)},!1)},init:function(){this.scene.setGravity(new THREE.Vector3(0,
-250,0));this.camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1E4);this.camera.position.set(0,250,1050);this.camera.lookAt(new THREE.Vector3(0,-50,0));this.cameraTarget=new THREE.Object3D;this.cameraTarget.add(this.camera);this.scene.add(this.cameraTarget);this.clawcamera.rotation.x=-Math.PI/2;var a=new THREE.PointLight(15790320,1);a.position.set(0,2E3,0);this.scene.add(a);a=new THREE.PointLight(15790320,.7);a.position.set(0,-600,0);this.camera.add(a);this.addEnviroment(2400,
2E3,2400);this.glasscontainer=this.addGlassContainer(600,500,600);this.glasscontainer.rotation.x=-Math.PI/2;this.glasscontainer.position.y=-250;this.glasscontainer.receiveShadow=!0;this.glasscontainer.width=600;this.glasscontainer.height=500;this.glasscontainer.depth=600;this.glasscontainer.minX=-300;this.glasscontainer.maxX=300;this.glasscontainer.minZ=-300;this.glasscontainer.maxZ=300;this.scene.add(this.glasscontainer);this.claw=this.addClaw(15,20,15,16,40,100);this.claw.position.set(-300+2*this.MINDISTANCE_TO_CONTAINER,
200,300-2*this.MINDISTANCE_TO_CONTAINER);this.scene.add(this.claw);for(a=0;2>a;a++){var b=this.addClawLimb(40,100);b.position.set(24*Math.cos(2*Math.PI/2*a)+this.claw.position.x,this.claw.position.y,-24*Math.sin(2*Math.PI/2*a)+this.claw.position.z);b.rotation.y=2*Math.PI/2*a;this.scene.add(b);this.clawconstraints[a]=new Physijs.DOFConstraint(b,this.claw,new THREE.Vector3(16*Math.cos(2*Math.PI/2*a)+this.claw.position.x,this.claw.position.y-10,-16*Math.sin(2*Math.PI/2*a)+this.claw.position.z));this.scene.addConstraint(this.clawconstraints[a]);
this.clawconstraints[a].setAngularLowerLimit(new THREE.Vector3(0,0,0));this.clawconstraints[a].setAngularUpperLimit(new THREE.Vector3(0,0,0))}a=new THREE.MeshPhongMaterial({color:0});this.TopCar=new Physijs.BoxMesh(new THREE.BoxGeometry(50,10,50),a,9E7);this.TopCar.position.set(this.claw.position.x,this.claw.position.y+50,this.claw.position.z);this.TopCar.targetPosition=this.TopCar.position.clone();this.TopCar.dropPosition=new THREE.Vector3(this.glasscontainer.minX+2*this.MINDISTANCE_TO_CONTAINER,
this.TopCar.position.y,this.glasscontainer.maxZ-2*this.MINDISTANCE_TO_CONTAINER);this.scene.add(this.TopCar);a=Math.PI/15;this.topcarconstraint=new Physijs.DOFConstraint(this.TopCar,this.claw,new THREE.Vector3(this.TopCar.position.x,this.TopCar.position.y-15,this.TopCar.position.z));this.scene.addConstraint(this.topcarconstraint);this.topcarconstraint.setLinearLowerLimit(new THREE.Vector3(0,0,0));this.topcarconstraint.setLinearUpperLimit(new THREE.Vector3(0,0,0));this.topcarconstraint.setAngularLowerLimit(new THREE.Vector3(-a,
-a,-a));this.topcarconstraint.setAngularUpperLimit(new THREE.Vector3(a,a,a));this.topcarbaseconstraint=new Physijs.DOFConstraint(this.TopCar,new THREE.Vector3(this.TopCar.position.x,this.TopCar.position.y+20,this.TopCar.position.z));this.scene.addConstraint(this.topcarbaseconstraint);this.topcarbaseconstraint.setLinearLowerLimit(new THREE.Vector3(-1200,0,-1200));this.topcarbaseconstraint.setLinearUpperLimit(new THREE.Vector3(1200,0,1200));this.topcarbaseconstraint.setAngularLowerLimit(new THREE.Vector3(0,
0,0));this.topcarbaseconstraint.setAngularUpperLimit(new THREE.Vector3(0,0,0));a=new THREE.LineBasicMaterial({color:986895});this.LineGeometry=new THREE.Geometry;this.LineGeometry.vertices.push(this.TopCar.position,this.claw.position);a=new THREE.Line(this.LineGeometry,a);this.scene.add(a);this.renderer=new THREE.WebGLRenderer({antialias:!0});this.renderer.setSize(window.innerWidth,window.innerHeight);document.getElementById("container").appendChild(this.renderer.domElement);this.setupPrizeContainer("prizeContainer",
"prizeCanvas");document.getElementById("PrizeButton").addEventListener("click",this.togglePrizeContainer,!1);document.getElementById("viewPrizeButton").addEventListener("click",this.togglePrizeContainer,!1);document.getElementById("restartButton").addEventListener("click",this.onAppRestart,!1);document.getElementById("container").addEventListener("mousedown",this.onMouseDownMain,!1);document.getElementById("container").addEventListener("mouseup",this.onMouseMoveMain,!1);document.getElementById("container").addEventListener("mouseup",
this.onMouseUpMain,!1);document.getElementById("checkPrizeButton").addEventListener("click",this.togglePrizeContainer,!1);document.getElementById("openWikiButton").addEventListener("click",this.toggleWikiPage,!1);window.addEventListener("keydown",this.onKeyDown,!1);window.addEventListener("resize",this.onWindowResize,!1);requestAnimationFrame(this.render);this.scene.simulate()},toggleWikiPage:function(){var a=document.getElementById("wikiContainer"),b=document.getElementById("arrowSymbol"),c=document.getElementById("wikiPage");
a.classList.toggle("open");b.innerHTML=a.classList.contains("open")?"&#x25B2":"&#x25BC";a.classList.contains("open")&&c.src!=App.currentPrizeToy.wiki_url?c.src=App.currentPrizeToy.wiki_url:""},onMouseDownMain:function(a){App.isMainCanvasMouseDown=!0;App.MainCanvasMouseDownLocation={x:a.clientX,y:a.clientY}},onMouseMoveMain:function(a){if(App.isMainCanvasMouseDown&&!App.isCameraAnimating){var b=void 0;1<App.MainCanvasMouseDownLocation.x-a.clientX?b=App.cameraTarget.rotation.y+Math.PI/2:-1>App.MainCanvasMouseDownLocation.x-
a.clientX&&(b=App.cameraTarget.rotation.y-Math.PI/2);void 0!==b&&(App.isMainCanvasMouseDown=!1,(new TWEEN.Tween(App.cameraTarget.rotation)).to({y:b},200).easing(TWEEN.Easing.Linear.None).onStart(function(){App.isCameraAnimating=!0}).onComplete(function(){App.isCameraAnimating=!1}).start())}},onMouseUpMain:function(a){App.isMainCanvasMouseDown=!1},onMouseDown:function(a){App.isClawAnimating||"moveright"!==this.id||(App.MouseDownInterval=setInterval(function(){App.onKeyDown({keyCode:68})},200))},onMouseUp:function(){clearInterval(App.MouseDownInterval)},
dropToy:function(a){var b=Object.keys(App.toys);a=a?a:1;for(var c=0;c<a;c++)App.leftAmount++,App.generateToy(1,App.toys[b[Math.floor(Math.random()*b.length)]],"Box")},onViewButtonClick:function(){App.PackageMaterial.transparent=!0;(new TWEEN.Tween(App.PackageMaterial)).to({opacity:.5},1E3).easing(TWEEN.Easing.Linear.None).onComplete(function(){(new TWEEN.Tween(App.PackageMaterial)).to({opacity:1},1E3).easing(TWEEN.Easing.Linear.None).onComplete(function(){App.PackageMaterial.transparent=!1}).start()}).start()},
onKeyDown:function(a){if(!App.isClawAnimating&&"Initial"!==App.status&&"Pause"!==App.status&&"End"!==App.status)switch(a.keyCode){case 39:case 68:App.onTopCarMove(App.MOVE_DISTANCE*Math.cos(-App.cameraTarget.rotation.y),App.MOVE_DISTANCE*Math.sin(-App.cameraTarget.rotation.y));break;case 37:case 65:App.onTopCarMove(-App.MOVE_DISTANCE*Math.cos(-App.cameraTarget.rotation.y),-App.MOVE_DISTANCE*Math.sin(-App.cameraTarget.rotation.y));break;case 40:case 83:App.onTopCarMove(App.MOVE_DISTANCE*Math.sin(App.cameraTarget.rotation.y),
App.MOVE_DISTANCE*Math.cos(App.cameraTarget.rotation.y));break;case 38:case 87:App.onTopCarMove(-App.MOVE_DISTANCE*Math.sin(App.cameraTarget.rotation.y),-App.MOVE_DISTANCE*Math.cos(App.cameraTarget.rotation.y));break;case 32:App.onCatch()}},isCarMoving:!1,onTopCarMove:function(a,b){App.isClawAnimating||App.TopCar.targetPosition.set(App.TopCar.position.x+a,App.TopCar.position.y,App.TopCar.position.z+b)},addEnviroment:function(a,b,c){a=new THREE.Mesh(new THREE.BoxGeometry(a,b,c),new THREE.MeshLambertMaterial({color:14935011,
side:THREE.DoubleSide,map:THREE.ImageUtils.loadTexture("img/bg.jpg")}));a.position.y=b/6;this.scene.add(a)},addEnivormentShelfs:function(){new THREE.Mesh(new THREE.BoxGeometry(600,10,100),new THREE.MeshNormalMaterial)},addGlassContainer:function(a,b,c){var d=new THREE.BoxGeometry(b,a,10),e=new THREE.BoxGeometry(a,b,10),f=new THREE.MeshPhongMaterial({color:16777215,refractionRatio:.985,transparent:!0,opacity:.3});d=new THREE.Mesh(d,f);var g=new THREE.Mesh(e,f),h=Physijs.createMaterial(new THREE.MeshBasicMaterial({transparent:!0,
opacity:0}),.3,.1);e=new Physijs.BoxMesh(new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:0}),0);var n=new Physijs.PlaneMesh(new THREE.PlaneGeometry(b,c),h,0);n.rotation.y=Math.PI/2;n.position.set(-a/2,0,b/2);var k=new Physijs.PlaneMesh(new THREE.PlaneGeometry(b,c),h,0);k.rotation.y=-Math.PI/2;k.position.set(a/2,0,b/2);var l=new Physijs.PlaneMesh(new THREE.PlaneGeometry(a,b),h,0);l.rotation.x=Math.PI/2;l.position.set(0,c/2,b/2);var m=new Physijs.PlaneMesh(new THREE.PlaneGeometry(a,
b),h,0);m.rotation.x=-Math.PI/2;m.position.set(0,-c/2,b/2);h=new Physijs.PlaneMesh(new THREE.PlaneGeometry(a,c),h,0);h.rotation.x=-Math.PI;h.position.set(0,0,b+100);n.add(d.clone());k.add(d.clone());l.add(g.clone());m.add(g.clone());e.add(n);e.add(k);e.add(l);e.add(m);e.add(h);d=new Physijs.BoxMesh(new THREE.BoxGeometry(200,1,100),f,0);d.position.set(-a/2+100,-c/2+200,50);f=new Physijs.BoxMesh(new THREE.BoxGeometry(1,200,100),f,0);f.position.set(-a/2+200,-c/2+100,50);g=new Physijs.BoxMesh(new THREE.BoxGeometry(195,
.1,195),new THREE.MeshBasicMaterial({color:16711680}),0);g.position.set(-a/2+100,-b/2-200,c/2-100);(new THREE.Mesh(new THREE.PlaneGeometry(200,200),new THREE.MeshBasicMaterial({color:0}))).position.set(-a/2+100,-c/2+100,.2);e.add(d);e.add(f);g.addEventListener("collision",this.onItemCollision);this.scene.add(g);f=new Physijs.BoxMesh(new THREE.BoxGeometry(a,c-200,1),new THREE.MeshBasicMaterial({color:14737632}),0);f.position.set(0,100,0);d=new Physijs.BoxMesh(new THREE.BoxGeometry(a-200,200,1),new THREE.MeshBasicMaterial({color:14737632}),
0);d.position.set(100,(-c+200)/2,0);e.add(f);e.add(d);d=[new THREE.MeshLambertMaterial({color:15790320,ambient:16777215,shininess:50,shading:THREE.SmoothShading,side:THREE.DoubleSide,map:THREE.ImageUtils.loadTexture("img/cartoonbear.jpg")}),new THREE.MeshLambertMaterial({color:15790320,ambient:16777215,shininess:50,shading:THREE.SmoothShading,side:THREE.DoubleSide,map:THREE.ImageUtils.loadTexture("img/pikachu.jpg")}),new THREE.MeshLambertMaterial({color:15790320,ambient:16777215,shininess:50,shading:THREE.SmoothShading,
side:THREE.DoubleSide,map:THREE.ImageUtils.loadTexture("img/yellowbird.jpg")}),new THREE.MeshLambertMaterial({color:15790320,ambient:16777215,shininess:50,shading:THREE.SmoothShading,side:THREE.DoubleSide,map:THREE.ImageUtils.loadTexture("img/minion.png")}),new THREE.MeshBasicMaterial({transparent:!0,opacity:0}),new THREE.MeshBasicMaterial({transparent:!0,opacity:0})];f=300;d=new THREE.Mesh(new THREE.BoxGeometry(a,c,f),new THREE.MeshFaceMaterial(d));d.position.set(0,0,-f/2);e.add(d);this.containerTopBoxTextureX=
THREE.ImageUtils.loadTexture("img/stripescolor.png");this.containerTopBoxTextureX.wrapT=THREE.RepeatWrapping;this.containerTopBoxTextureX.wrapS=THREE.RepeatWrapping;this.containerTopBoxTextureX.repeat.set(1,5);this.containerTopBoxTextureZ=THREE.ImageUtils.loadTexture("img/stripescolor.png");this.containerTopBoxTextureZ.wrapT=THREE.RepeatWrapping;this.containerTopBoxTextureZ.wrapS=THREE.RepeatWrapping;this.containerTopBoxTextureZ.repeat.set(5,1);d=[new THREE.MeshLambertMaterial({map:this.containerTopBoxTextureX,
color:13607241,shininess:50,shading:THREE.SmoothShading}),new THREE.MeshLambertMaterial({map:this.containerTopBoxTextureX,color:16436540,shininess:50,shading:THREE.SmoothShading}),new THREE.MeshLambertMaterial({map:this.containerTopBoxTextureZ,color:15784736,shininess:50,shading:THREE.SmoothShading}),new THREE.MeshLambertMaterial({map:this.containerTopBoxTextureZ,color:16506466,shininess:50,shading:THREE.SmoothShading}),new THREE.MeshBasicMaterial({transparent:!0,opacity:0}),new THREE.MeshBasicMaterial({transparent:!0,
opacity:0})];f=100;a=new THREE.Mesh(new THREE.BoxGeometry(a,c,f),new THREE.MeshFaceMaterial(d));a.position.set(0,0,b+f/2);e.add(a);return e},onItemCollision:function(a,b,c,d){a.category&&"claw"===a.category||"Initial"===App.status||(App.generateSound("prize"),App.scene.remove(a),a=a.children[0].name,App.currentPrizeToy=App.prizeToys[a],App.prizePlaceHolder[a]&&(App.prizePlaceHolder[a].visible=!1),App.currentPrizeToy.visible=!0,App.currentPrizeToy.count++,App.updateToyAmount(),App.score+=App.perToyScore,
App.isCaptured=!0,setTimeout(function(){App.isCaptured=!1},3E3),App.toys[a].isCatched=!0,App.togglePrizeContainer(!0),(new TWEEN.Tween(App.prizecamera.position)).to({x:App.currentPrizeToy.position.x},3E3).easing(TWEEN.Easing.Exponential.Out).start())},generateToy:function(a,b,c){for(var d=0;d<a;d++){var e=this.generatePackage(c,b);b&&b.model||console.log(b,b.model);e.add(b.model.clone());var f=(Math.random()-.5)*(this.glasscontainer.width-200),g=(Math.random()-.5)*(this.glasscontainer.depth-200);
f<-this.glasscontainer.width/2+200&&(f=-this.glasscontainer.width/2+200);g>this.glasscontainer.depth/2-200&&(g=this.glasscontainer.depth/2-200);e.position.set(f,-170,g);this.toysArray.push(e);this.scene.add(e)}},getPackageMaterial:function(a,b){var c=new THREE.ImageUtils.loadTexture("img/question.png");c.wrapS=THREE.RepeatWrapping;c.wrapT=THREE.RepeatWrapping;c.anisotropy=16;switch(b){case "x":c.repeat.set(a.boundingBox.depth/a.boundingBox.height/2,.5);break;case "y":c.repeat.set(.5,a.boundingBox.depth/
a.boundingBox.width/2);break;case "z":c.repeat.set(a.boundingBox.width/a.boundingBox.height/2,.5)}return new THREE.MeshLambertMaterial({color:16777215,map:c})},generatePackage:function(a,b){var c=[this.getPackageMaterial(b,"x"),this.getPackageMaterial(b,"x"),this.getPackageMaterial(b,"y"),this.getPackageMaterial(b,"y"),this.getPackageMaterial(b,"z"),this.getPackageMaterial(b,"z")];c=new THREE.MeshFaceMaterial(c);switch(a){case "Box":var d=new Physijs.BoxMesh(new THREE.BoxGeometry(b.boundingBox.width,
b.boundingBox.height,b.boundingBox.depth),c,300);break;case "Sphere":d=new Physijs.SphereMesh(new THREE.SphereGeometry(b.boundingBox.width/2,6,6),c,300)}return d},addClaw:function(a,b,c,d,e,f){a=new Physijs.BoxMesh(new THREE.CylinderGeometry(1.5*b,1.5*b,c,d),new THREE.MeshBasicMaterial,1E4);b=new THREE.Mesh(new THREE.CylinderGeometry(2*b,2*b,2*c,d),new THREE.MeshPhongMaterial({map:THREE.ImageUtils.loadTexture("img/clawmaterial.jpg")}));a.add(b);a.claws=[];return a},addClawLimb:function(a,b){var c=
Physijs.createMaterial(new THREE.MeshPhongMaterial({map:THREE.ImageUtils.loadTexture("img/clawmaterial.jpg")}),1,0),d=new Physijs.CylinderMesh(new THREE.CylinderGeometry(10,50,a-5,2),c,400),e=new Physijs.BoxMesh(new THREE.BoxGeometry(100,b,5),c,200),f=new Physijs.BoxMesh(new THREE.BoxGeometry(100,4,10),c,200);c=new THREE.Mesh(new THREE.SphereGeometry(2.5,8,4),c);f.category="claw";f.position.set(-1.5,-b/2,-5);e.category="claw";e.add(f);e.position.set(-b/2,-a/2,0);e.rotation.set(Math.PI/2,0,-Math.PI/
2);c.position.set(0,-a/2,0);d.category="claw";d.add(e);d.add(c);d.position.z=5;d.rotation.z=Math.PI/1.5;return d},onCatch:function(){if(!App.isClawAnimating){var a=new THREE.Vector3(0,0,0);(new TWEEN.Tween(a)).to({y:-App.DROPDISTANCE},1800).easing(TWEEN.Easing.Cubic.Out).onStart(function(){App.onClawRelease();App.isClawAnimating=!0}).onUpdate(function(){App.topcarconstraint.setLinearLowerLimit(this)}).start();(new TWEEN.Tween).to({},1900).onStart(function(){var a=new Audio("sound/down.mp3");a.volume=
.2;a.play()}).onComplete(function(){App.onClawCatch();setTimeout(function(){App.onRetrive(!0)},1E3)}).start()}},onRetrive:function(a){a&&(a=new THREE.Vector3(0,-App.DROPDISTANCE,0),(new TWEEN.Tween(a)).to({y:0},2500).easing(TWEEN.Easing.Linear.None).onUpdate(function(){App.topcarconstraint.setLinearLowerLimit(this)}).onComplete(function(){App.onBringToDropZone()}).start(),(new TWEEN.Tween).to({},500).onComplete(function(){var a=new Audio("sound/up.mp3");a.volume=.2;a.play()}).start())},onBringToDropZone:function(){(new TWEEN.Tween(App.TopCar.position)).to({x:App.TopCar.dropPosition.x,
z:App.TopCar.dropPosition.z},2E3).easing(TWEEN.Easing.Linear.None).onUpdate(function(){App.TopCar.__dirtyPosition=!0}).onComplete(function(){App.TopCar.targetPosition=App.TopCar.position.clone();setTimeout(function(){App.onClawRelease();App.isClawAnimating=!1},200)}).start()},onClawCatch:function(){var a=Math.PI/4;App.clawconstraints[0].configureAngularMotor(2,-a,0,-2,1E6);App.clawconstraints[0].enableAngularMotor(2);App.clawconstraints[1].configureAngularMotor(2,0,a,2,1E6);App.clawconstraints[1].enableAngularMotor(2)},
onClawRelease:function(){App.clawconstraints[0].setAngularLowerLimit(new THREE.Vector3(0,0,0));App.clawconstraints[0].setAngularUpperLimit(new THREE.Vector3(0,0,0));App.clawconstraints[0].disableAngularMotor(2);App.clawconstraints[1].setAngularLowerLimit(new THREE.Vector3(0,0,0));App.clawconstraints[1].setAngularUpperLimit(new THREE.Vector3(0,0,0));App.clawconstraints[1].disableAngularMotor(2)},onWindowResize:function(){App.camera.aspect=window.innerWidth/window.innerHeight;App.camera.updateProjectionMatrix();
App.renderer.setSize(window.innerWidth,window.innerHeight)},render:function(){TWEEN.update();App.isCaptured&&(App.containerTopBoxTextureX.offset.y+=.03,App.containerTopBoxTextureZ.offset.x-=.03);App.LineGeometry.verticesNeedUpdate=!0;App.TopCar.targetPosition&&!App.isClawAnimating&&(App.TopCar.position.x+=.05*(App.TopCar.targetPosition.x-App.TopCar.position.x),App.TopCar.position.z+=.05*(App.TopCar.targetPosition.z-App.TopCar.position.z),App.TopCar.__dirtyPosition=!0,parseFloat(App.TopCar.position.x-
App.MINDISTANCE_TO_CONTAINER)<App.glasscontainer.minX&&(App.TopCar.position.x=App.glasscontainer.minX+App.MINDISTANCE_TO_CONTAINER,App.TopCar.__dirtyPosition=!0),parseFloat(App.TopCar.position.x+App.MINDISTANCE_TO_CONTAINER)>App.glasscontainer.maxX&&(App.TopCar.position.x=App.glasscontainer.maxX-App.MINDISTANCE_TO_CONTAINER,App.TopCar.__dirtyPosition=!0),parseFloat(App.TopCar.position.z-App.MINDISTANCE_TO_CONTAINER)<App.glasscontainer.minZ&&(App.TopCar.position.z=App.glasscontainer.minZ+App.MINDISTANCE_TO_CONTAINER,
App.TopCar.__dirtyPosition=!0),parseFloat(App.TopCar.position.z+App.MINDISTANCE_TO_CONTAINER)>App.glasscontainer.maxZ&&(App.TopCar.position.z=App.glasscontainer.maxZ-App.MINDISTANCE_TO_CONTAINER,App.TopCar.__dirtyPosition=!0));App.scene.simulate(void 0,1);App.renderer.render(App.scene,App.camera);if(!document.getElementById("prizeContainer").classList.contains("close")){if(App.currentPrizeToy){if(App.prizePlaceHolder[App.currentPrizeToy.name].visible){var a=.05*(App.currentPrizeToy.currentPrizeToyTargetRotation-
App.prizePlaceHolder[App.currentPrizeToy.name].rotation.z);App.prizePlaceHolder[App.currentPrizeToy.name].rotation.z+=a}App.currentPrizeToy.visible&&(a=.05*(App.currentPrizeToy.currentPrizeToyTargetRotation-App.currentPrizeToy.rotation.z),App.currentPrizeToy.rotation.z+=a)}App.prizerenderer.render(App.prizescene,App.prizecamera)}requestAnimationFrame(App.render)},setupPrizeContainer:function(a,b){function c(a,b){App.updateArrowUI();App.updateTextUI();App.updatePagination();var c=b?b:App.currentPrizeToy;
(new TWEEN.Tween(App.prizecamera.position)).to({x:c.position.x},a).easing(TWEEN.Easing.Elastic.Out).start()}function d(a){l=a.clientX-(window.innerWidth/2+g.clientWidth/2);App.currentPrizeToy.currentPrizeToyTargetRotation=p+.02*(l-m)}function e(a){document.removeEventListener("mousemove",d,!1);document.removeEventListener("mouseup",e,!1);document.removeEventListener("mouseout",f,!1)}function f(a){document.removeEventListener("mousemove",d,!1);document.removeEventListener("mouseup",e,!1);document.removeEventListener("mouseout",
f,!1)}document.getElementById(a);var g=document.getElementById(b);this.prizecamera=new THREE.PerspectiveCamera(40,g.clientWidth/g.clientHeight,.1,1E4);this.prizecamera.position.set(0,0,200);this.prizescene.add(this.prizecamera);var h=new THREE.PointLight(16777215,.2);h.position.set(0,0,300);h.name="light";this.prizescene.add(h);h=new THREE.DirectionalLight(16777215,.825);h.position.set(1,1,1).normalize();h.name="light";this.prizescene.add(h);h=new THREE.DirectionalLight(16777215,.825);h.position.set(-1,
-1,-1).normalize();h.name="light";this.prizescene.add(h);this.prizerenderer=new THREE.WebGLRenderer({alpha:!0});this.prizerenderer.setClearColor(0,0);this.prizerenderer.setSize(g.clientWidth,g.clientHeight);g.appendChild(this.prizerenderer.domElement);this.loadPrizes();document.getElementsByClassName("PrizeArrow right")[0].addEventListener("click",function(){var a=Object.keys(App.toys);a.length<=a.indexOf(App.currentPrizeToy.name)+1||(App.currentPrizeToy=App.prizeToys[a[a.indexOf(App.currentPrizeToy.name)+
1]],c(1E3))},!1);document.getElementsByClassName("PrizeArrow left")[0].addEventListener("click",function(){var a=Object.keys(App.toys);0===a.indexOf(App.currentPrizeToy.name)?arrowLeftButton.classList.add("hide"):(App.currentPrizeToy=App.prizeToys[a[a.indexOf(App.currentPrizeToy.name)-1]],c(1E3))},!1);for(var n in this.prizeToys){h=document.getElementById("pageContainer");var k=document.createElement("div");k.classList.add("pageDot");k.name=n;k.addEventListener("click",function(){App.currentPrizeToy=
App.prizeToys[this.name];c(1E3,App.currentPrizeToy)},!1);h.appendChild(k)}g.addEventListener("mousedown",function(a){a.preventDefault();document.addEventListener("mousemove",d,!1);document.addEventListener("mouseup",e,!1);document.addEventListener("mouseout",f,!1);m=a.clientX-(window.innerWidth/2+g.clientWidth/2);App.currentPrizeToy&&(p=App.currentPrizeToy.currentPrizeToyTargetRotation)},!1);var l=0,m=0,p=0},generateSound:function(a){switch(a){case "button":var b=document.getElementById("buttonSound");
break;case "prize":b=document.getElementById("prizeSound")}b.play()},updateArrowUI:function(){var a=Object.keys(App.toys),b=document.getElementsByClassName("PrizeArrow right")[0],c=document.getElementsByClassName("PrizeArrow left")[0];b.classList.remove("hide");c.classList.remove("hide");a.indexOf(App.currentPrizeToy.name)>=a.length-1&&b.classList.add("hide");0>=a.indexOf(App.currentPrizeToy.name)&&c.classList.add("hide")},updateTextUI:function(){var a=document.getElementById("textContainer"),b=document.getElementById("wikiContainer"),
c=document.getElementById("openWikiButton"),d=document.getElementById("arrowSymbol"),e=a.getElementsByClassName("text count")[0],f=a.getElementsByClassName("text multiply")[0];b.classList.remove("open");App.currentPrizeToy&&0<App.currentPrizeToy.count?(d.innerHTML=b.classList.contains("open")?"&#x25B2":"&#x25BC",c.style.display="block",c.textContent=App.currentPrizeToy.name,e.textContent=App.currentPrizeToy.count,f.textContent="X",a.classList.add("show")):(c.style.display="none",c.textContent="",
e.textContent="",f.textContent="",a.classList.remove("show"))},updatePagination:function(){for(var a=document.getElementsByClassName("pageDot"),b=0;b<a.length;b++)a[b].classList.contains("active")&&a[b].classList.remove("active"),a[b].name===App.currentPrizeToy.name&&(a[b].classList.add("active"),!a[b].classList.contains("acquired")&&0<App.currentPrizeToy.count&&a[b].classList.add("acquired"))},updateToyAmount:function(){App.leftAmount--},loadPrizes:function(){var a=new THREE.ColladaLoader;a.options.convertUpAxis=
!0;a.load("model/question.dae",function(a){for(var b in App.toys){var d=a.scene.clone();d.position.x=App.toys[b].element_position.x;d.position.y=-80;d.scale.multiplyScalar(40);var e=new THREE.MeshLambertMaterial({color:15790320});d.traverse(function(a){a.material&&(a.material=e)});App.prizePlaceHolder[b]=d;App.prizescene.add(d)}})},togglePrizeContainer:function(a){!0===a?"":App.generateSound("button");var b=document.getElementById("prizeContainer"),c=document.getElementById("checkPrizeButton");!0===
a?b.classList.remove("close"):(b.classList.toggle("close"),b.classList.contains("close")&&App.leftAmount<parseInt(2*App.initialItemCount/3)&&App.dropToy(parseInt(App.initialItemCount/3)));"End"===App.status?(a=document.getElementById("GameOverMenu"),b.classList.contains("close")?(a.classList.add("open"),c.style.opacity=1):(a.classList.remove("open"),c.style.opacity=0)):(b.classList.contains("close")?(App.onAppResume(),c.style.opacity=1):(App.onAppPause(),c.style.opacity=0),App.updateArrowUI(),App.updateTextUI(),
App.updatePagination())}};window.onload=App.preloadAssets();window.console={};window.console.error=window.console.log=window.console.warn=function(){};